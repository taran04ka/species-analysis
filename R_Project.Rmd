---
title: "R Project: National Parks Species"
---

# libraries 
```{r}
libs <- c("tidyverse", "tidytuesdayR", "scales")

installed_libs <- libs %in% rownames(installed.packages())
if (any(installed_libs == F)) {
    install.packages(libs[!installed_libs])
} else{
  print("All the libraries already installed")
}
```

```{r}
library(tidyverse)
library(tidytuesdayR)
library(scales)
```

```{r message=FALSE, warning=FALSE}
data <- read_csv("species.csv")

data

```

```{r message=FALSE, warning=FALSE}

top_orders <- data %>%
  filter(CategoryName %in% c("Mammal", "Bird", "Reptile", "Amphibian", "Fish"), 
         !is.na(Order)) %>%
  count(Order, sort = TRUE) %>%
  top_n(10, n) %>%
  pull(Order)

filtered_data <- data %>%
  filter(Order %in% top_orders, CategoryName %in% c("Mammal", "Bird", "Reptile", "Amphibian", "Fish"))

ggplot(filtered_data, aes(x = Order, fill = Order)) +
  geom_bar() +
  labs(title = "Count of Observations by Top 10 Orders (Most frequent animal orders)",
       x = "Order",
       y = "Number of Observations",
       fill = "Order") +
  theme_minimal() +
  coord_flip() 


````

