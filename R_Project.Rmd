---
title: "R Project: National Parks Species"
---

# libraries 
```{r}
libs <- c("tidyverse", "tidytuesdayR", "scales", "ggthemes", "RColorBrewer")

installed_libs <- libs %in% rownames(installed.packages())
if (any(installed_libs == F)) {
    install.packages(libs[!installed_libs])
} else{
  print("All the libraries already installed")
}
```

```{r}
library(tidyverse)
library(tidytuesdayR)
library(scales)
library(ggthemes)
library(RColorBrewer)
```

```{r message=FALSE, warning=FALSE}
data <- read_csv("species.csv")

data

```

```{r}
# Amount of species in every park
species_amount <- 
  data %>% 
    filter(Occurrence %in% c("Present", "Probably Present")) %>%   
    group_by(ParkName) %>% 
    distinct(SciName, .keep_all = TRUE) %>%
    ungroup()

species_amount
```

```{r}
barchart_species_amount <-
  ggplot(data = species_amount, aes(x = ParkCode, fill = CategoryName, colour = CategoryName)) +
  geom_bar() +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(
    title = "Amount of different species in the USA National Parks",
    x = "National Park Code",
    y = "Number of Species",
    fill = "Category Name"
  ) +
  guides(
    color = "none"
  ) +
  scale_fill_viridis_d(option = "viridis")

barchart_species_amount
```