---
title: "R Project: National Parks Species"
---

# libraries 
```{r}
libs <- c("tidyverse", "tidytuesdayR", "scales")

installed_libs <- libs %in% rownames(installed.packages())
if (any(installed_libs == F)) {
    install.packages(libs[!installed_libs])
} else{
  print("All the libraries already installed")
}
```

```{r}
library(tidyverse)
library(tidytuesdayR)
library(scales)
```

```{r message=FALSE, warning=FALSE}
data <- read_csv("species.csv")

data

```


```{r message=FALSE, warning=FALSE}

status_counts <- data %>%
  group_by(ParkCode, Occurrence) %>%
  summarize(Count = n(), .groups = 'drop')

ggplot(status_counts, aes(x = ParkCode, y = Count, fill = Occurrence)) +
  geom_bar(stat = "identity", position = "fill") +
  theme_minimal() +
  labs(title = "Species Occurence in the parks",
       x = "Park",
       y = "Proportion") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

````


```{r message=FALSE, warning=FALSE}

status_counts <- data %>%
  group_by(ParkCode, Abundance) %>%
  summarize(Count = n(), .groups = 'drop')

ggplot(status_counts, aes(x = ParkCode, y = Count, fill = Abundance)) +
  geom_bar(stat = "identity", position = "fill") +
  theme_minimal() +
  labs(title = "Species Occurence in the parks",
       x = "Park",
       y = "Proportion") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

````